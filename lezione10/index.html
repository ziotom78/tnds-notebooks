<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/tnds-notebooks/libs/katex/katex.min.css"> <link rel=stylesheet  href="/tnds-notebooks/libs/highlight/github.min.css"> <link rel=stylesheet  href="/tnds-notebooks/css/franklin.css"> <link rel=stylesheet  href="/tnds-notebooks/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/tnds-notebooks/assets/favicon.png"> <title>Lezioni 10 e 11</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h1><a href="/tnds-notebooks/">TNDS</a></h1> <p class=lead >Prof. M.&nbsp;Tomasi</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/tnds-notebooks/">Home</a> <a class="sidebar-nav-item " href="/tnds-notebooks/lezione07/">Lezione 07</a> <a class="sidebar-nav-item " href="/tnds-notebooks/lezione08/">Lezione 08</a> <a class="sidebar-nav-item active" href="/tnds-notebooks/lezione10/">Lezioni 10 e 11</a> </nav> <p>&copy; Maurizio Tomasi.</p> </div> </div> <div class="content container"> <div class=franklin-content > <p>Dal momento che la lezione 11 richiede di impiegare i codici sviluppati nella lezione 10, presento gli esercizi delle due lezioni in un&#39;unica pagina.</p> <p><div class=franklin-toc ><ol><li><a href="#esercizio_101">Esercizio 10.1</a><ol><li><a href="#generatore_lineare_congruenziale">Generatore Lineare Congruenziale</a><li><a href="#distribuzione_esponenziale">Distribuzione esponenziale</a><li><a href="#distribuzione_gaussiana">Distribuzione Gaussiana</a><li><a href="#distribuzione_gaussiana_con_metodo_accept-reject">Distribuzione Gaussiana con metodo Accept-Reject</a></ol><li><a href="#esercizio_102">Esercizio 10.2</a><li><a href="#esercizio_110">Esercizio 11.0</a><li><a href="#esercizio_111">Esercizio 11.1</a></ol></div> </p> <p>Iniziamo importando i pacchetti che ci serviranno.</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Printf
<span class=hljs-keyword >using</span> Plots
<span class=hljs-keyword >using</span> Statistics</code></pre> <h2 id=esercizio_101 ><a href="#esercizio_101" class=header-anchor >Esercizio 10.1</a></h2> <p>In Julia non esiste il concetto di «classe», ma esistono le <code>struct</code> che funzionano in modo concettualmente simile. Non permettono di associare metodi, tranne eventualmente un semplice costruttore. Definiamo una classe <code>GLC</code> che sia equivalente alla classe <code>Random</code> che vi viene richiesto di implementare in C&#43;&#43;.</p> <h3 id=generatore_lineare_congruenziale ><a href="#generatore_lineare_congruenziale" class=header-anchor >Generatore Lineare Congruenziale</a></h3> <pre><code class="julia hljs"><span class=hljs-keyword >mutable struct</span> GLC
    a::<span class=hljs-built_in >UInt64</span>
    c::<span class=hljs-built_in >UInt64</span>
    m::<span class=hljs-built_in >UInt64</span>
    seed::<span class=hljs-built_in >UInt64</span>

    GLC(myseed) = new(<span class=hljs-number >1664525</span>, <span class=hljs-number >1013904223</span>, <span class=hljs-number >1</span> &lt;&lt; <span class=hljs-number >31</span>, myseed)
<span class=hljs-keyword >end</span></code></pre> <p>Definiamo ora una funzione <code>rand</code> che restituisca un numero casuale floating-point compreso in un intervallo:</p> <pre><code class="julia hljs"><span class=hljs-meta >@doc</span> <span class=hljs-string >&quot;&quot;&quot;
    rand(glc::GLC, xmin, xmax)

Return a pseudo-random number uniformly distributed in the
interval [xmin, xmax).
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> rand(glc::GLC, xmin, xmax)
    glc.seed = (glc.a * glc.seed + glc.c) % glc.m
    xmin + (xmax - xmin) * glc.seed / glc.m
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">rand</code></pre>
<p>È molto comodo avere anche una funzione <code>rand</code> che usi l&#39;intervallo <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><mn>1</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >1</span><span class=mclose >]</span></span></span></span>.</p>
<pre><code class="julia hljs"><span class=hljs-meta >@doc</span> <span class=hljs-string >&quot;&quot;&quot;
    rand(glc::GLC)

Return a pseudo-random number uniformly distributed in the
interval [0, 1).
&quot;&quot;&quot;</span>
rand(glc::GLC) = rand(glc, <span class=hljs-number >0.0</span>, <span class=hljs-number >1.0</span>)</code></pre><pre><code class="plaintext hljs">rand</code></pre>
<p>Le funzioni definite sopra forniscono una guida, definita dalla macro <code>@doc</code> e invocabile dalla REPL col carattere <code>?</code> seguito dal nome della funzione:</p>
<pre><code class="julia hljs">julia&gt; ?randgauss</code></pre>
<p>Questi sono i numeri che dovreste aspettarvi se avete implementato bene il vostro codice &#40;notate che i numeri cambiano se usate un seed diverso&#33;&#41;.</p>
<pre><code class="julia hljs">glc = GLC(<span class=hljs-number >1</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >5</span>
    println(i, <span class=hljs-string >&quot;: &quot;</span>, rand(glc))
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">1: 0.47291105054318905
2: 0.7385413474403322
3: 0.008484064601361752
4: 0.40976652735844254
5: 0.10108725726604462
</code></pre>
<p>Preoccupatevi quindi di creare una serie di <code>assert</code> nel vostro codice C&#43;&#43; che verifichino che ottenete gli stessi valori se partite dallo stesso seme &#40;<code>1</code>&#41;, possibilmente in una funzione <code>test_random_numbers&#40;&#41;</code> invocata all&#39;inizio del vostro <code>main</code>.</p>
<p>Quando si implementano numeri pseudo-casuali, è sempre bene farsi un&#39;idea della distribuzione dei valori. Disegnamo quindi l&#39;istogramma della distribuzione di un gran numero di campioni, e verifichiamo che siano uniformemente distribuiti nell&#39;intervallo &#91;0, 1&#41;.</p>
<pre><code class="julia hljs">histogram([rand(glc) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10000</span>], label=<span class=hljs-string >&quot;&quot;</span>)</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/rand_hist.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/rand_hist.svg" alt="">
<h3 id=distribuzione_esponenziale ><a href="#distribuzione_esponenziale" class=header-anchor >Distribuzione esponenziale</a></h3>
<p>Trattandosi di una formula semplice, in Julia si può definire <code>randexp</code> con una sola riga di codice:</p>
<pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    randexp(glc::GLC)

Return a positive pseudo-random number distributed with a
probability density ``p(x) = λ e^{-λ x}``.
&quot;&quot;&quot;</span>
randexp(glc::GLC, λ) = -log(<span class=hljs-number >1</span> - rand(glc)) / λ</code></pre><pre><code class="plaintext hljs">randexp</code></pre>
<p>Questi sono i numeri per i vostri <code>assert</code>:</p>
<pre><code class="julia hljs">glc = GLC(<span class=hljs-number >1</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >5</span>
    println(i, <span class=hljs-string >&quot;: &quot;</span>, randexp(glc, <span class=hljs-number >1</span>))
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">1: 0.6403859601352556
2: 1.3414791243855002
3: 0.008520259140710315
4: 0.5272371040158115
5: 0.10656930958385337
</code></pre>
<p>Questo è l&#39;istogramma</p>
<pre><code class="julia hljs">histogram([randexp(glc, <span class=hljs-number >1</span>) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10000</span>], label=<span class=hljs-string >&quot;&quot;</span>)</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/randexp_hist.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/randexp_hist.svg" alt="">
<h3 id=distribuzione_gaussiana ><a href="#distribuzione_gaussiana" class=header-anchor >Distribuzione Gaussiana</a></h3>
<pre><code class="julia hljs"><span class=hljs-meta >@doc</span> <span class=hljs-string >raw&quot;&quot;&quot;
    randgauss(glc::GLC, μ, σ)

Return a pseudo-random number distributed with a probability
density ``p(x) = \frac{1}{\sqrt{2πσ^2}}
\exp\left(-\frac{(x - μ)^2}{2σ^2}\right)``, using the
Box-Müller algorithm.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> randgauss(glc::GLC, μ, σ)
    s = rand(glc)
    t = rand(glc)
    x = sqrt(-<span class=hljs-number >2</span>log(<span class=hljs-number >1</span> - s)) * cos(<span class=hljs-number >2</span><span class=hljs-literal >π</span> * t)
    μ + σ * x
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">randgauss</code></pre>
<p>Questi sono i numeri per i vostri <code>assert</code>:</p>
<pre><code class="julia hljs">glc = GLC(<span class=hljs-number >1</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >5</span>
    println(i, <span class=hljs-string >&quot;: &quot;</span>, randgauss(glc, <span class=hljs-number >2</span>, <span class=hljs-number >1</span>))
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">1: 1.9185906933235062
2: 1.8898847197814346
3: 1.9682233298032183
4: 2.960947466486181
5: 1.9538792463229713
</code></pre>
<p>Questo è l&#39;istogramma:</p>
<pre><code class="julia hljs">histogram([randgauss(glc, <span class=hljs-number >2</span>, <span class=hljs-number >1</span>) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10000</span>], label=<span class=hljs-string >&quot;&quot;</span>)</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/randgauss_hist.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/randgauss_hist.svg" alt="">
<h3 id=distribuzione_gaussiana_con_metodo_accept-reject ><a href="#distribuzione_gaussiana_con_metodo_accept-reject" class=header-anchor >Distribuzione Gaussiana con metodo Accept-Reject</a></h3>
<pre><code class="julia hljs"><span class=hljs-meta >@doc</span> <span class=hljs-string >raw&quot;&quot;&quot;
    randgauss_ar(glc::GLC, μ, σ)

Return a pseudo-random number distributed with a probability
density ``p(x) = \frac1{\sqrt{2πσ^2}}
\exp\left(-\frac{(x - μ)^2}{2σ^2}\right)``, using the
accept-reject algorithm.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> randgauss_ar(glc::GLC, μ, σ)
    <span class=hljs-keyword >while</span> <span class=hljs-literal >true</span>  <span class=hljs-comment ># Loop forever</span>
        x = rand(glc, -<span class=hljs-number >5.</span>, <span class=hljs-number >5.</span>)
        y = rand(glc)
        g = exp(-x^<span class=hljs-number >2</span> / <span class=hljs-number >2</span>)
        y ≤ g &amp;&amp; <span class=hljs-keyword >return</span> μ + x * σ
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">randgauss_ar</code></pre>
<p>Questi sono i numeri per gli <code>assert</code>:</p>
<pre><code class="julia hljs">glc = GLC(<span class=hljs-number >1</span>)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >5</span>
    println(i, <span class=hljs-string >&quot;: &quot;</span>, randgauss_ar(glc, <span class=hljs-number >2</span>, <span class=hljs-number >1</span>))
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">1: 1.7291105054318905
2: 2.4952592495828867
3: 2.009022830054164
4: 0.6520544346421957
5: 1.318840131163597
</code></pre>
<p>Questo è l&#39;istogramma:</p>
<pre><code class="julia hljs">histogram([randgauss_ar(glc, <span class=hljs-number >2</span>, <span class=hljs-number >1</span>) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10000</span>], label=<span class=hljs-string >&quot;&quot;</span>)</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/randgauss_ar_hist.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/randgauss_ar_hist.svg" alt="">
<h2 id=esercizio_102 ><a href="#esercizio_102" class=header-anchor >Esercizio 10.2</a></h2>
<p>Questa è una semplice implementazione dell&#39;integrale della media:</p>
<pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    intmean(glc::GLC, fn, a, b, N)

Evaluate the integral of `fn(x)` in the interval ``[a, b]``
using the mean method with ``N`` points.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> intmean(glc::GLC, fn, a, b, N)
    (b - a) * sum([fn(rand(glc, a, b)) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:N]) / N
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">intmean</code></pre>
<p>L&#39;integrale <em>hit-or-miss</em> è solo lievemente più complicato:</p>
<pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    inthm(glc::GLC, fn, a, b, fmax, N)

Evaluate the integral of `fn(x)` in the interval ``[a, b]``
using the hit-or-miss method with ``N`` points, assuming that
`fn(x)` assumes values in the range `[0, fmax]`.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> inthm(glc::GLC, fn, a, b, fmax, N)
    hits = <span class=hljs-number >0</span>
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:N
        x = rand(glc, a, b)
        y = rand(glc, <span class=hljs-number >0</span>, fmax)
        y ≤ fn(x) &amp;&amp; (hits += <span class=hljs-number >1</span>)
    <span class=hljs-keyword >end</span>

    hits / N * (b - a) * fmax
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">inthm</code></pre>
<p>Verifichiamo che il codice compili, e che produca un risultato sensato. Teniamo presente che <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>π</mi></msubsup><mi>sin</mi><mo>⁡</mo><mi>x</mi><mtext> </mtext><mi mathvariant=normal >d</mi><mi>x</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\int_0^\pi \sin x\,\mathrm{d}x = 2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.215112em;vertical-align:-0.35582em;"></span><span class=mop ><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8592920000000001em;"><span style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.2579000000000002em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35582em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop >sin</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathrm">d</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span></span></span></span>; inoltre, siccome <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\sin(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >sin</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span> è una funzione limitata in <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><mn>1</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >1</span><span class=mclose >]</span></span></span></span>, possiamo porre <code>fmax&#61;1</code> nella chiamata a <code>inthm</code>:</p>
<pre><code class="julia hljs">println(<span class=hljs-string >&quot;Integrale (metodo media):&quot;</span>, intmean(GLC(<span class=hljs-number >1</span>), sin, <span class=hljs-number >0</span>, <span class=hljs-literal >π</span>, <span class=hljs-number >100</span>))
println(<span class=hljs-string >&quot;Integrale (metodo hit-or-miss):&quot;</span>, inthm(GLC(<span class=hljs-number >1</span>), sin, <span class=hljs-number >0</span>, <span class=hljs-literal >π</span>, <span class=hljs-number >1</span>, <span class=hljs-number >100</span>))</code></pre><pre><code class="plaintext hljs">Integrale (metodo media):1.8715046084621125
Integrale (metodo hit-or-miss):1.9477874452256718
</code></pre>
<p>Implementate degli <code>assert</code> che verifichino che ottenete gli stessi risultati nella vostra implementazione C&#43;&#43;. Come già ricordato sopra, fate molta attenzione ad inizializzare il generatore di numeri pseudo-casuali con lo stesso seme &#40;<code>1</code> in questo caso&#41;.</p>
<p>Eseguiamo ora il calcolo per 10.000 volte e facciamone l&#39;istogramma: osserviamo che la distribuzione è approssimativamente una Gaussiana, come previsto.</p>
<pre><code class="julia hljs">glc = GLC(<span class=hljs-number >1</span>)
mean_samples = [intmean(glc, sin, <span class=hljs-number >0</span>, <span class=hljs-literal >π</span>, <span class=hljs-number >100</span>) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10_000</span>]
histogram(mean_samples, label=<span class=hljs-string >&quot;Media&quot;</span>)

glc = GLC(<span class=hljs-number >1</span>)  <span class=hljs-comment ># Reset the random generator</span>
mean_hm = [inthm(glc, sin, <span class=hljs-number >0</span>, <span class=hljs-literal >π</span>, <span class=hljs-number >1</span>, <span class=hljs-number >100</span>) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >10_000</span>]
histogram!(mean_hm, label=<span class=hljs-string >&quot;Hit-or-miss&quot;</span>)</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/mc_integrals.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/mc_integrals.svg" alt="">
<p>Se l&#39;andamento dell&#39;errore è della forma <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo stretchy=false >(</mo><mi>N</mi><mo stretchy=false >)</mo><mo>=</mo><mi>k</mi><mi mathvariant=normal >/</mi><msqrt><mi>N</mi></msqrt></mrow><annotation encoding="application/x-tex">\epsilon(N) = k/\sqrt{N}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.176665em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mord >/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9266650000000001em;"><span class=svg-align  style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord  style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-2.886665em;"><span class=pstrut  style="height:3em;"></span><span class=hide-tail  style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.11333499999999996em;"><span></span></span></span></span></span></span></span></span>, con <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> numero di punti, allora nel nostro caso possiamo stimare <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> immediatamente dalla deviazione standard dei valori in <code>values</code> mediante la formula <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msqrt><mi>N</mi></msqrt><mo>×</mo><mi>ϵ</mi><mo stretchy=false >(</mo><mi>N</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">k =
\sqrt{N} \times \epsilon(N)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.04em;vertical-align:-0.11333499999999996em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9266650000000001em;"><span class=svg-align  style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord  style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-2.886665em;"><span class=pstrut  style="height:3em;"></span><span class=hide-tail  style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.11333499999999996em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span></span></span></span>:</p>
<pre><code class="julia hljs">k_mean = √<span class=hljs-number >100</span> * std(mean_samples)
k_hm = √<span class=hljs-number >100</span> * std(mean_hm)

println(<span class=hljs-string >&quot;K (media) = &quot;</span>, k_mean)
println(<span class=hljs-string >&quot;K (hit-or-miss) = &quot;</span>, k_hm)</code></pre><pre><code class="plaintext hljs">K (media) = 0.9574569402133133
K (hit-or-miss) = 1.4987026076211012
</code></pre>
<p>A questo punto, per rispondere alla domanda del problema, è sufficiente risolvere l&#39;equazione <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.001</mn><mo>=</mo><mi>k</mi><mi mathvariant=normal >/</mi><msqrt><mi>N</mi></msqrt></mrow><annotation encoding="application/x-tex">0.001 = k/\sqrt{N}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0.001</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.176665em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mord >/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9266650000000001em;"><span class=svg-align  style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord  style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-2.886665em;"><span class=pstrut  style="height:3em;"></span><span class=hide-tail  style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.11333499999999996em;"><span></span></span></span></span></span></span></span></span> per <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, ossia </p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>N</mi><mo>=</mo><msup><mrow><mo fence=true >(</mo><mfrac><mi>k</mi><mn>0.001</mn></mfrac><mo fence=true >)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">N =
\left(\frac{k}{0.001}\right)^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.604038em;vertical-align:-0.95003em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >0.001</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.6540080000000001em;"><span style="top:-3.9029000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>
<p>.</p>
<pre><code class="julia hljs">noptim_mean = round(<span class=hljs-built_in >Int</span>, (k_mean/<span class=hljs-number >0.001</span>)^<span class=hljs-number >2</span>)
noptim_hm = round(<span class=hljs-built_in >Int</span>, (k_hm/<span class=hljs-number >0.001</span>)^<span class=hljs-number >2</span>)

println(<span class=hljs-string >&quot;N (media) = &quot;</span>, noptim_mean)
println(<span class=hljs-string >&quot;N (hit-or-miss) = &quot;</span>, noptim_hm)</code></pre><pre><code class="plaintext hljs">N (media) = 916724
N (hit-or-miss) = 2246110
</code></pre>
<p>Per verificare la correttezza del risultato, rifacciamo l&#39;istogramma. Siccome ci vuole molto tempo per ottenere il risultato, verifichiamo il risultato solo nel caso del metodo della media, e per un numero ridotto di realizzazioni &#40;1000 anziché 10.000&#41;:</p>
<pre><code class="julia hljs">glc = GLC(<span class=hljs-number >1</span>)
values = [intmean(glc, sin, <span class=hljs-number >0</span>, <span class=hljs-literal >π</span>, noptim_mean) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >1000</span>]
histogram(values, label=<span class=hljs-string >&quot;&quot;</span>)</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/mc_intmean.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/mc_intmean.svg" alt="">
<p>Il risultato è effettivamente corretto:</p>
<pre><code class="julia hljs">std(values)</code></pre><pre><code class="plaintext hljs">0.001000082648024251</code></pre>
<h1 id=lezione_11_metodi_monte_carlo ><a href="#lezione_11_metodi_monte_carlo" class=header-anchor >Lezione 11: Metodi Monte Carlo</a></h1>
<h2 id=esercizio_110 ><a href="#esercizio_110" class=header-anchor >Esercizio 11.0</a></h2>
<p>Definiamo una serie di variabili per le costanti fisiche del problema:</p>
<pre><code class="julia hljs">σ_θ = <span class=hljs-number >0.3e-3</span>;
θ<span class=hljs-number >0_</span>ref = <span class=hljs-literal >π</span> / <span class=hljs-number >2</span>;
Aref = <span class=hljs-number >2.7</span>;
Bref = <span class=hljs-number >60_000e-18</span>;
α = deg2rad(<span class=hljs-number >60.0</span>);
λ<span class=hljs-number >1</span> = <span class=hljs-number >579.1e-9</span>;
λ<span class=hljs-number >2</span> = <span class=hljs-number >404.7e-9</span>;</code></pre>
<p>La funzione <code>n_cauchy</code> restituisce <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> supponendo vera la formula di Cauchy. La sintassi con un parametro usa i valori di riferimento di <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> scritti sopra.</p>
<pre><code class="julia hljs">n_cauchy(λ, A, B) = sqrt(A + B / λ^<span class=hljs-number >2</span>)
n_cauchy(λ) = n_cauchy(λ, Aref, Bref)</code></pre><pre><code class="plaintext hljs">n_cauchy (generic function with 2 methods)</code></pre>
<p>La funzione <code>n</code> invece restituisce <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> in funzione della deviazione misurata <code>δ</code> dal prisma, dove <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> è il suo angolo di apertura &#40;definito sopra&#41;.</p>
<pre><code class="julia hljs">n(δ) = sin((δ + α) / <span class=hljs-number >2</span>) / sin(α / <span class=hljs-number >2</span>)
δ(n) = <span class=hljs-number >2</span>asin(n * sin(α / <span class=hljs-number >2</span>)) - α</code></pre><pre><code class="plaintext hljs">δ (generic function with 1 method)</code></pre>
<p>Queste formule si ricavano banalmente dall&#39;inversione della formula di Cauchy; la funzione <code>A_and_B</code> calcola contemporaneamente <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>, ed è stata definita per comodità:</p>
<pre><code class="julia hljs">A(λ<span class=hljs-number >1</span>, δ<span class=hljs-number >1</span>, λ<span class=hljs-number >2</span>, δ<span class=hljs-number >2</span>) = (λ<span class=hljs-number >2</span>^<span class=hljs-number >2</span> * n(δ<span class=hljs-number >2</span>)^<span class=hljs-number >2</span> - λ<span class=hljs-number >1</span>^<span class=hljs-number >2</span> * n(δ<span class=hljs-number >1</span>)^<span class=hljs-number >2</span>) / (λ<span class=hljs-number >2</span>^<span class=hljs-number >2</span> - λ<span class=hljs-number >1</span>^<span class=hljs-number >2</span>)
B(λ<span class=hljs-number >1</span>, δ<span class=hljs-number >1</span>, λ<span class=hljs-number >2</span>, δ<span class=hljs-number >2</span>) = (n(δ<span class=hljs-number >2</span>)^<span class=hljs-number >2</span> - n(δ<span class=hljs-number >1</span>)^<span class=hljs-number >2</span>) / (<span class=hljs-number >1</span>/λ<span class=hljs-number >2</span>^<span class=hljs-number >2</span> - <span class=hljs-number >1</span>/λ<span class=hljs-number >1</span>^<span class=hljs-number >2</span>)
A_and_B(λ<span class=hljs-number >1</span>, δ<span class=hljs-number >1</span>, λ<span class=hljs-number >2</span>, δ<span class=hljs-number >2</span>) = (A(λ<span class=hljs-number >1</span>, δ<span class=hljs-number >1</span>, λ<span class=hljs-number >2</span>, δ<span class=hljs-number >2</span>), B(λ<span class=hljs-number >1</span>, δ<span class=hljs-number >1</span>, λ<span class=hljs-number >2</span>, δ<span class=hljs-number >2</span>))</code></pre><pre><code class="plaintext hljs">A_and_B (generic function with 1 method)</code></pre>
<p>Calcoliamo allora i valori di riferimento di <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy=false >(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy=false >)</mo><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n(\lambda_1) = n_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">λ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy=false >(</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy=false >)</mo><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n(\lambda_2) = n_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">λ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, supponendo veri i valori di <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> scritti sopra r&#40;<code>A_ref</code> e <code>B_ref</code>&#41;:</p>
<pre><code class="julia hljs">n1_ref, n2_ref = n_cauchy(λ<span class=hljs-number >1</span>), n_cauchy(λ<span class=hljs-number >2</span>)</code></pre><pre><code class="plaintext hljs">(1.6967362539886182, 1.751096919705952)</code></pre>
<p>Da <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> calcoliamo quanto aspettarci per <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\delta_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\delta_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>:</p>
<pre><code class="julia hljs">δ<span class=hljs-number >1_</span>ref, δ<span class=hljs-number >2_</span>ref = δ(n1_ref), δ(n2_ref)</code></pre><pre><code class="plaintext hljs">(0.9785928129680508, 1.0859421943701004)</code></pre>
<p>A questo punto possiamo simulare l&#39;esperimento. La simulazione della misura di <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\delta_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\delta_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> va fatta usando l&#39;approssimazione Gaussiana con i valori medi <code>δ1_ref</code> e <code>δ2_ref</code>, e la deviazione standard <code>σ_θ</code> data dal testo dell&#39;esercizio:</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> simulate_experiment(glc, nsim)
    n1_simul = <span class=hljs-built_in >Array</span>{<span class=hljs-built_in >Float64</span>}(<span class=hljs-literal >undef</span>, nsim)
    n2_simul = <span class=hljs-built_in >Array</span>{<span class=hljs-built_in >Float64</span>}(<span class=hljs-literal >undef</span>, nsim)

    A_simul = <span class=hljs-built_in >Array</span>{<span class=hljs-built_in >Float64</span>}(<span class=hljs-literal >undef</span>, nsim)
    B_simul = <span class=hljs-built_in >Array</span>{<span class=hljs-built_in >Float64</span>}(<span class=hljs-literal >undef</span>, nsim)

    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:nsim
        θ<span class=hljs-number >0</span> = randgauss(glc, θ<span class=hljs-number >0_</span>ref, σ_θ)
        θ<span class=hljs-number >1</span> = randgauss(glc, θ<span class=hljs-number >0_</span>ref + δ<span class=hljs-number >1_</span>ref, σ_θ)
        θ<span class=hljs-number >2</span> = randgauss(glc, θ<span class=hljs-number >0_</span>ref + δ<span class=hljs-number >2_</span>ref, σ_θ)
        δ<span class=hljs-number >1</span>, δ<span class=hljs-number >2</span> = θ<span class=hljs-number >1</span> - θ<span class=hljs-number >0</span>, θ<span class=hljs-number >2</span> - θ<span class=hljs-number >0</span>
        n1, n2 = n(δ<span class=hljs-number >1</span>), n(δ<span class=hljs-number >2</span>)
        a, b = A_and_B(λ<span class=hljs-number >1</span>, δ<span class=hljs-number >1</span>, λ<span class=hljs-number >2</span>, δ<span class=hljs-number >2</span>)

        n1_simul[i] = n1
        n2_simul[i] = n2

        A_simul[i] = a
        B_simul[i] = b
    <span class=hljs-keyword >end</span>

    (n1_simul, n2_simul, A_simul, B_simul)
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">simulate_experiment (generic function with 1 method)</code></pre>
<p>Ecco i primi 5 valori della simulazione; controllate che siano gli stessi che ottenete voi, facendo attenzione di usare come seme <code>1</code> e che l&#39;ordine in cui chiamate la funzione per generare i numeri casuali sia la stessa del codice sopra:</p>
<ol>
<li><p><em>Prima</em> si genera <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\theta_0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>;</p>

<li><p><em>Poi</em> si generano <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\theta_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\theta_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>

</ol>
<p>Nel fare i plot qui sotto mi limito a ripetere l&#39;esperimento 1000 volte &#40;il testo richiede 10.000 volte&#41;. I risultati non cambiano molto.</p>
<pre><code class="julia hljs">glc = GLC(<span class=hljs-number >1</span>)
n1_simul, n2_simul, A_simul, B_simul = simulate_experiment(glc, <span class=hljs-number >1000</span>)

<span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;%14s %14s %14s %14s\n&quot;</span>, <span class=hljs-string >&quot;n₁&quot;</span>, <span class=hljs-string >&quot;n₂&quot;</span>, <span class=hljs-string >&quot;A&quot;</span>, <span class=hljs-string >&quot;B&quot;</span>)
println(repeat(<span class=hljs-string >&#x27;-&#x27;</span>, <span class=hljs-number >62</span>))
<span class=hljs-keyword >for</span> i = <span class=hljs-number >1</span>:<span class=hljs-number >5</span>
    <span class=hljs-comment ># We use scientific notation for B, as it is ≪1</span>
    <span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;%14.6f %14.6f %14.6f %14.6e\n&quot;</span>,
            n1_simul[i], n2_simul[i], A_simul[i], B_simul[i])
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">            n₁             n₂              A              B
--------------------------------------------------------------
      1.696732       1.751104       2.699946   6.001302e-14
      1.696576       1.751053       2.699084   6.012505e-14
      1.696956       1.751007       2.701759   5.966046e-14
      1.696639       1.750918       2.699958   5.990405e-14
      1.696847       1.751016       2.701005   5.978917e-14
</code></pre>
<pre><code class="julia hljs">histogram([n1_simul, n2_simul],
          label = [<span class=hljs-string >&quot;n₁&quot;</span>, <span class=hljs-string >&quot;n₂&quot;</span>],
          layout = (<span class=hljs-number >2</span>, <span class=hljs-number >1</span>))</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/hist_n1_n2.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/hist_n1_n2.svg" alt="">
<pre><code class="julia hljs">scatter(n1_simul, n2_simul, label=<span class=hljs-string >&quot;&quot;</span>)</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/scatter_n1_n2.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/scatter_n1_n2.svg" alt="">
<p>Il package <code>Statistics</code> di Julia implementa il calcolo della covarianza tra due serie, che è uguale alla correlazione a meno di una normalizzazione. Definiamo quindi la funzione <code>corr</code>, che calcola il coefficiente di correlazione, analogamente a questa; nel vostro codice C&#43;&#43; dovrete invece implementarla usando la formula.</p>
<pre><code class="julia hljs">corr(x, y) = cov(x, y) / (std(x) * std(y))</code></pre><pre><code class="plaintext hljs">corr (generic function with 1 method)</code></pre>
<p>I valori di <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ed <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> sono correlati, perché sono entrambi stati ricavati dalla medesima stima di <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\theta_0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<pre><code class="julia hljs">corr(n1_simul, n2_simul)</code></pre><pre><code class="plaintext hljs">0.48866240146170203</code></pre>
<p>Dal momento che <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>≪</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">B \ll 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≪</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>, applichiamo ad esso un fattore di scala <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>14</mn></msup></mrow><annotation encoding="application/x-tex">10^{14}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord >1</span><span class=mord ><span class=mord >0</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">14</span></span></span></span></span></span></span></span></span></span></span></span>:</p>
<pre><code class="julia hljs">histogram([A_simul, B_simul * <span class=hljs-number >1e14</span>],
          label = [<span class=hljs-string >&quot;A&quot;</span> <span class=hljs-string >&quot;B × 10^14&quot;</span>],
          layout = (<span class=hljs-number >2</span>, <span class=hljs-number >1</span>))</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/hist_A_B.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/hist_A_B.svg" alt="">
<pre><code class="julia hljs">scatter(A_simul, B_simul * <span class=hljs-number >1e14</span>, label=<span class=hljs-string >&quot;&quot;</span>)</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/scatter_A_B.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/scatter_A_B.svg" alt="">
<p>Ricalcoliamo qui i coefficienti di correlazione nel caso in cui l&#39;esperimento sia rifatto 10.000 volte. Notate che creo di nuovo un generatore di numeri casuali.</p>
<pre><code class="julia hljs">glc = GLC(<span class=hljs-number >1</span>)
(n1_simul, n2_simul, A_simul, B_simul) = simulate_experiment(glc, <span class=hljs-number >10_000</span>)
println(<span class=hljs-string >&quot;Correlazione tra n1 e n2: &quot;</span>, corr(n1_simul, n2_simul))
println(<span class=hljs-string >&quot;Correlazione tra A e B: &quot;</span>, corr(A_simul, B_simul))</code></pre><pre><code class="plaintext hljs">Correlazione tra n1 e n2: 0.5056534544299343
Correlazione tra A e B: -0.8682861987372527
</code></pre>
<h2 id=esercizio_111 ><a href="#esercizio_111" class=header-anchor >Esercizio 11.1</a></h2>
<p>L&#39;esercizio 11.1 è preso da un vecchio tema d&#39;esame, e va svolto in modo molto simile al precedente. Si tratta di misurare il coefficiente di viscosità <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span> partendo dalla velocità di caduta di una sferetta di metallo all&#39;interno di un cilindro pieno di glicerina, tramite la formula </p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>v</mi><mi>L</mi></msub><mo>=</mo><mfrac><mrow><mn>2</mn><msup><mi>R</mi><mn>2</mn></msup></mrow><mrow><mn>9</mn><mi>η</mi></mrow></mfrac><mo stretchy=false >(</mo><mi>ρ</mi><mo>−</mo><msub><mi>ρ</mi><mn>0</mn></msub><mo stretchy=false >)</mo><mi>g</mi><mo>=</mo><mfrac><mrow><mi mathvariant=normal >Δ</mi><mi>x</mi></mrow><mrow><mi mathvariant=normal >Δ</mi><mi>t</mi></mrow></mfrac><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> v_L =
\frac{2R^2}{9\eta}(\rho - \rho_0) g = \frac{\Delta x}{\Delta t}, </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.371548em;vertical-align:-0.8804400000000001em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.491108em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >9</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mopen >(</span><span class="mord mathnormal">ρ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">ρ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.04633em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >Δ</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >Δ</span><span class="mord mathnormal">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mpunct >,</span></span></span></span></span>
<p>dove <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Δ</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">\Delta x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Δ</span><span class="mord mathnormal">x</span></span></span></span> è la lunghezza del tratto percorso in caduta dalla sferetta e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Δ</span><span class="mord mathnormal">t</span></span></span></span> il tempo impiegato. La relazione si inverte facilmente per dare </p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>η</mi><mo>=</mo><mfrac><mrow><mn>2</mn><msup><mi>R</mi><mn>2</mn></msup><mtext> </mtext><mi>g</mi><mtext> </mtext><mi mathvariant=normal >Δ</mi><mi>t</mi></mrow><mrow><mn>9</mn><mtext> </mtext><mi mathvariant=normal >Δ</mi><mi>x</mi></mrow></mfrac><mo stretchy=false >(</mo><mi>ρ</mi><mo>−</mo><msub><mi>ρ</mi><mn>0</mn></msub><mo stretchy=false >)</mo><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex">
\eta = \frac{2R^2\,g\,\Delta t}{9\,\Delta x}(\rho - \rho_0), </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.177108em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.491108em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >9</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >Δ</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >Δ</span><span class="mord mathnormal">t</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mopen >(</span><span class="mord mathnormal">ρ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">ρ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mpunct >,</span></span></span></span></span>
<p>dove le quantità misurate in ognuno degli esperimenti Monte Carlo sono <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Δ</mi><mi>x</mi><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\Delta x
= x_1 - x_0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Δ</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, e <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Δ</span><span class="mord mathnormal">t</span></span></span></span>.</p>
<p>Definiamo le costanti numeriche del problema, esprimendole tutte nel S.I. &#40;anche <code>x0</code>, <code>x1</code> e <code>Δx</code>&#33;&#41;</p>
<pre><code class="julia hljs">δt, δx, δR = <span class=hljs-number >0.01</span>, <span class=hljs-number >0.001</span>, <span class=hljs-number >0.0001</span>
ρ, ρ<span class=hljs-number >0</span> = <span class=hljs-number >2700.0</span>, <span class=hljs-number >1250.0</span>
g = <span class=hljs-number >9.81</span>
η_true = <span class=hljs-number >0.83</span>
R_true = <span class=hljs-built_in >Float64</span>[<span class=hljs-number >0.01</span>, <span class=hljs-number >0.005</span>]
x0 = <span class=hljs-number >0.2</span>
x1 = <span class=hljs-number >0.6</span>
Δx_true = x1 - x0</code></pre><pre><code class="plaintext hljs">0.39999999999999997</code></pre>
<p>Definiamo anche alcune relazioni matematiche.</p>
<pre><code class="julia hljs">v_L(R, η) = <span class=hljs-number >2</span>R^<span class=hljs-number >2</span> / (<span class=hljs-number >9</span>η) * (ρ - ρ<span class=hljs-number >0</span>) * g
Δt(R, Δx, η) = Δx / v_L(R, η)
Δt_true = <span class=hljs-built_in >Float64</span>[Δt(R, Δx_true, η_true) <span class=hljs-keyword >for</span> R <span class=hljs-keyword >in</span> R_true]
η(R, Δt, Δx) = <span class=hljs-number >2</span>R^<span class=hljs-number >2</span> * g * Δt / (<span class=hljs-number >9</span>Δx) * (ρ - ρ<span class=hljs-number >0</span>)</code></pre><pre><code class="plaintext hljs">η (generic function with 1 method)</code></pre>
<p>Definiamo ora la funzione <code>simulate</code>, che effettua <em>due</em> esperimenti: uno con <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>0.01</mn><mtext> </mtext><mtext>m</mtext></mrow><annotation encoding="application/x-tex">R = 0.01\,\text{m}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0.01</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class=mord >m</span></span></span></span></span> e l&#39;altro con <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>0.005</mn><mtext> </mtext><mtext>m</mtext></mrow><annotation encoding="application/x-tex">R = 0.005\,\text{m}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0.005</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class=mord >m</span></span></span></span></span>.</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> simulate(glc::GLC, δx, δt, δR)
    <span class=hljs-comment ># Misura dell&#x27;altezza iniziale</span>
    cur_x0 = randgauss(glc, x0, δx)
    <span class=hljs-comment ># Misura dell&#x27;altezza finale</span>
    cur_x1 = randgauss(glc, x1, δx)

    <span class=hljs-comment ># Questo array di 2 elementi conterrà le due stime di η</span>
    <span class=hljs-comment ># (corrispondenti ai due possibili raggi della sferetta)</span>
    estimated_η = zeros(<span class=hljs-number >2</span>)
    <span class=hljs-keyword >for</span> case <span class=hljs-keyword >in</span> [<span class=hljs-number >1</span>, <span class=hljs-number >2</span>]
        <span class=hljs-comment ># Misura delle dimensioni della sferetta</span>
        cur_R = randgauss(glc, R_true[case], δR)
        cur_Δx = cur_x1 - cur_x0

        <span class=hljs-comment ># Misura del tempo necessario per cadere da cur_x0 a cur_x1</span>
        cur_Δt = randgauss(glc, Δt_true[case], δt)

        <span class=hljs-comment ># Stima di η</span>
        estimated_η[case] = η(cur_R, cur_Δt, cur_Δx)
    <span class=hljs-keyword >end</span>

    estimated_η
<span class=hljs-keyword >end</span></code></pre><pre><code class="plaintext hljs">simulate (generic function with 1 method)</code></pre>
<p>Eseguiamo ora 1000 simulazioni e facciamo l&#39;istogramma della stima di <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span> per i due raggi della sferetta.</p>
<pre><code class="julia hljs">N = <span class=hljs-number >1_000</span>
glc = GLC(<span class=hljs-number >1</span>)

η<span class=hljs-number >1</span> = <span class=hljs-built_in >Array</span>{<span class=hljs-built_in >Float64</span>}(<span class=hljs-literal >undef</span>, N)
η<span class=hljs-number >2</span> = <span class=hljs-built_in >Array</span>{<span class=hljs-built_in >Float64</span>}(<span class=hljs-literal >undef</span>, N)
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:N
    (η<span class=hljs-number >1</span>[i], η<span class=hljs-number >2</span>[i]) = simulate(glc, δx, δt, δR)
<span class=hljs-keyword >end</span>

histogram(η<span class=hljs-number >2</span>, label=<span class=hljs-meta >@sprintf</span>(<span class=hljs-string >&quot;R = %.3f m&quot;</span>, R_true[<span class=hljs-number >2</span>]))
histogram!(η<span class=hljs-number >1</span>, label=<span class=hljs-meta >@sprintf</span>(<span class=hljs-string >&quot;R = %.3f m&quot;</span>, R_true[<span class=hljs-number >1</span>]))</code></pre><pre><code class="plaintext hljs">&quot;/home/runner/work/tnds-notebooks/tnds-notebooks/__site/assets/lezione10/code/output/hist_eta1_eta2.svg&quot;</code></pre>
<img src="/tnds-notebooks/assets/lezione10/code/output/hist_eta1_eta2.svg" alt="">
<p>Si tratta ora di stimare le incertezze di <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span> al variare degli errori considerati.</p>
<pre><code class="julia hljs"><span class=hljs-comment ># In η1 ed η2 abbiamo già le stime di η considerando tutti</span>
<span class=hljs-comment ># e tre gli errori</span>
<span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;Tutti gli errori: δη = %.4f kg/m/s (R1)\n&quot;</span>, std(η<span class=hljs-number >1</span>))
<span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;                     = %.4f kg/m/s (R2)\n&quot;</span>, std(η<span class=hljs-number >2</span>))

<span class=hljs-comment ># Ora dobbiamo eseguire di nuovo N esperimenti, assumendo che</span>
<span class=hljs-comment ># l&#x27;errore sia presente in una sola delle tre quantità</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:N
    (η<span class=hljs-number >1</span>[i], η<span class=hljs-number >2</span>[i]) = simulate(glc, <span class=hljs-number >0.0</span>, <span class=hljs-number >0.0</span>, δR)
<span class=hljs-keyword >end</span>
<span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;Solo δR:          δη = %.4f kg/m/s (R1)\n&quot;</span>, std(η<span class=hljs-number >1</span>))
<span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;                     = %.4f kg/m/s (R2)\n&quot;</span>, std(η<span class=hljs-number >2</span>))

<span class=hljs-comment ># Idem</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:N
    (η<span class=hljs-number >1</span>[i], η<span class=hljs-number >2</span>[i]) = simulate(glc, <span class=hljs-number >0.0</span>, δt, <span class=hljs-number >0.0</span>)
<span class=hljs-keyword >end</span>
<span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;Solo δt:          δη = %.4f kg/m/s (R1)\n&quot;</span>, std(η<span class=hljs-number >1</span>))
<span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;                     = %.4f kg/m/s (R2)\n&quot;</span>, std(η<span class=hljs-number >2</span>))

<span class=hljs-comment ># Idem</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:N
    (η<span class=hljs-number >1</span>[i], η<span class=hljs-number >2</span>[i]) = simulate(glc, δx, <span class=hljs-number >0.0</span>, <span class=hljs-number >0.0</span>)
<span class=hljs-keyword >end</span>
<span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;Solo δx:          δη = %.4f kg/m/s (R1)\n&quot;</span>, std(η<span class=hljs-number >1</span>))
<span class=hljs-meta >@printf</span>(<span class=hljs-string >&quot;                     = %.4f kg/m/s (R2)\n&quot;</span>, std(η<span class=hljs-number >2</span>))</code></pre><pre><code class="plaintext hljs">Tutti gli errori: δη = 0.0186 kg/m/s (R1)
                     = 0.0334 kg/m/s (R2)
Solo δR:          δη = 0.0160 kg/m/s (R1)
                     = 0.0327 kg/m/s (R2)
Solo δt:          δη = 0.0078 kg/m/s (R1)
                     = 0.0020 kg/m/s (R2)
Solo δx:          δη = 0.0028 kg/m/s (R1)
                     = 0.0028 kg/m/s (R2)
</code></pre>

<div class=page-foot >
  <div class=copyright >
    &copy; Maurizio Tomasi. Last modified: November 28, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    </div>